<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Start using memoization to reduce computing time | Hello there.</title>
    <meta name="description" content="Things Iggy writes about">
    
    
    <link rel="preload" href="/assets/css/0.styles.74245eb8.css" as="style"><link rel="preload" href="/assets/js/app.411ac2ac.js" as="script"><link rel="preload" href="/assets/js/2.826a9c57.js" as="script"><link rel="preload" href="/assets/js/19.4431ab75.js" as="script"><link rel="prefetch" href="/assets/js/10.33a00c4d.js"><link rel="prefetch" href="/assets/js/11.9e2c5904.js"><link rel="prefetch" href="/assets/js/12.82d02492.js"><link rel="prefetch" href="/assets/js/13.2bba91b0.js"><link rel="prefetch" href="/assets/js/14.496d3aa4.js"><link rel="prefetch" href="/assets/js/15.8e326966.js"><link rel="prefetch" href="/assets/js/16.a4da2abb.js"><link rel="prefetch" href="/assets/js/17.8eec3b06.js"><link rel="prefetch" href="/assets/js/18.edb89630.js"><link rel="prefetch" href="/assets/js/20.4463634e.js"><link rel="prefetch" href="/assets/js/21.d60a97f5.js"><link rel="prefetch" href="/assets/js/22.443a8923.js"><link rel="prefetch" href="/assets/js/23.cdd341e7.js"><link rel="prefetch" href="/assets/js/3.14889d81.js"><link rel="prefetch" href="/assets/js/4.6512c86b.js"><link rel="prefetch" href="/assets/js/5.839bfab5.js"><link rel="prefetch" href="/assets/js/6.3a95a3b3.js"><link rel="prefetch" href="/assets/js/7.00a5fbce.js"><link rel="prefetch" href="/assets/js/8.27c044bc.js"><link rel="prefetch" href="/assets/js/9.b297b1cf.js">
    <link rel="stylesheet" href="/assets/css/0.styles.74245eb8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><header class="px-6 bg-white flex flex-wrap items-center py-8"><input type="checkbox" id="menu-toggle" class="hidden"> <label id="hamburger" for="menu-toggle" class="fixed cursor-pointer block z-20"><div id="burgerToggle" class="cursor-pointer"><span></span> <span></span> <span></span></div></label> <div id="sideMenu" class="bg-gray-800 z-10 fixed top-0 left-0 bottom-0 w-64"><ul class="my-16 mx-4"><li class="my-4 cursor-default hover:no-underline"><div class="container flex flex-col items-start justify-center"><div class="my-4"><img src="/assets/img/iggy_square.57401581.jpg" class="ml-0 h-20 w-20 mb-4 rounded-full"> <div class="font-bold text-white mb-4">Igor Irianto</div> <div class="font-light text-gray-500 text-sm">Frontend dev who likes to post about Vim, JS, and other computer stuff. Lives in Dallas. Married. He doesn't have a lot of twitter follower so you should <a href="https://twitter.com/iggredible">add him</a>.</div></div></div></li> <li class="my-4 text-white font-light"><a href="#">Blogs</a></li> <li class="my-4 text-white font-light"><a href="#">About</a></li></ul></div> <div class="absolute top-0 right-0 m-4"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></header> <div class="container max-w-5xl mx-auto"><!----> <div class="max-w-4xl mx-auto"><div class="relative"><div class="fixed top-4 left-0 pl-5"><a href="/">Home</a></div> <div class="content mx-16 lg:mx-24"><h1 class="text-center">Start using memoization to reduce computing time</h1> <h6 class="text-center italic font-light m-4">introduction to javascript memoization</h6> <h4></h4> <div class="content__default"><p>One classic CS question is to create <a href="(https://www.mathsisfun.com/numbers/fibonacci-sequence.html)">Fibonacci</a> sequence. One of the solutions is a recursive function and it looks something like this:</p> <div class="language- extra-class"><pre class="language-text"><code>function fib(n) {
  if (n === 0 || n === 1)
    return n;
  else
    return fib(n - 1) + fib(n - 2);
}
</code></pre></div><p>A major problem with recursive fibonacci function above is that it is an expensive function. It calls itself too many times. Calling fib(40) took about 30 seconds on my poor 2015 Macbook air (it calls itself <em>102,334,155</em> times), fib(45) almost 5 minutes (calls itself <em>1,134,903,170</em> times - a <strong>billion</strong> time).</p> <p>Good luck calling fib(100).</p> <p><img src="https://media.giphy.com/media/qQdL532ZANbjy/giphy.gif" alt="tearful cry"></p> <p>Is there anything we can do to shorten an expensive function like this?</p> <h1 id="enter-memoization"><a href="#enter-memoization" aria-hidden="true" class="header-anchor">#</a> Enter memoization</h1> <p><a href="https://en.wikipedia.org/wiki/Memoization" target="_blank" rel="noopener noreferrer">Memoization<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (rhymes with memorization) is a technique in CS to save previous result into a cache so when the function is called again with same argument, it would just return value from the cache and execute the function again. It is useful for expensive functions like fibonacci.</p> <h1 id="how-do-we-use-memoization-on-fibonacci"><a href="#how-do-we-use-memoization-on-fibonacci" aria-hidden="true" class="header-anchor">#</a> How do we use memoization on fibonacci?</h1> <p>We can use:</p> <div class="language- extra-class"><pre class="language-text"><code>const fib = (function() {
  const cache = {};

  function f(n) {
    let value;

    if (n in cache) {
      value = cache[n];
    } else {
      if (n === 0 || n === 1)
        value = n;
      else
        value = f(n - 1) + f(n - 2);

        cache[n] = value;
    }

    return value;
  }

  return f;
})();
</code></pre></div><p>(Source: <a href="https://www.sitepoint.com/implementing-memoization-in-javascript/" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. All credit for above goes to author).</p> <p>Try the function above and run fib(40), fib(50), and even fib(100). You'll feel the difference.</p> <h1 id="how-does-memoization-works"><a href="#how-does-memoization-works" aria-hidden="true" class="header-anchor">#</a> How does memoization works?</h1> <p>It stores values on JS object (<code>const cache = {};</code>) so if the same value is called again, it will fetch the value from <code>cache</code> instead of executing the function.</p> <p>Let's say we want to call fib(5). When fib(5) is called the first time, since cache is empty and it could not find 5 in cache (<code>if (n in cache)</code> is falsy), it executes fibonacci logic (<code>value = f(n - 1) + f(n - 2);</code>) and then saves the result to cache  (<code>cache[n] = value;</code>). Now we have a cache for <code>n = 5</code> - something like this: <code>{5: 5}</code> (btw, value of fib(5) is 5).</p> <p>The next time we call fib(5) again, it finds (<code>{5: 5}</code>) in cache. Instead of executing fib(5) again, it simply returns the value from cache lookup <code>value = cache[n]; ... return value;</code>. Since our fibonacci is recursive, when we call for fib(5), it automatically fills up the cache with values up to 5. Calling fib(5) creates cache for fib(4), fib(3), etc.</p> <p>Another example is, say we have just called fib(49) and we want to call fib(50) next. Before we call fib(50), inside our cache, we would have cache values like this:</p> <div class="language- extra-class"><pre class="language-text"><code>{
  0: 0,
  1: 1,
  2: 1,
  3: 2,
  ...
  48: 4807526976,
  49: 7778742049
}
</code></pre></div><p>We already have values from 0 to 49! All we need to do is to call <code>value = f(n - 1) + f(n - 2);</code> - aka fib(49) + fib(48), which we already have stored in cache! This is how memoized fib(50) returns the result almost instantaneously compared to its non-memoized version.</p> <h1 id="sweet-i-am-going-to-memoize-every-function-in-sight"><a href="#sweet-i-am-going-to-memoize-every-function-in-sight" aria-hidden="true" class="header-anchor">#</a> Sweet! I am going to memoize every function in sight!</h1> <p>Unfortunately, not everything is memoizable. We can only memoize pure functions.</p> <p>To be a pure function, it must:</p> <ol><li>Have return value</li> <li>Does not depend on arguments other than its own argument</li> <li>Does not mutate values outside of its scope</li></ol> <p>Pure function is out of this article's scope, but check this <a href="https://blog.bitsrc.io/understanding-javascript-mutation-and-pure-functions-7231cc2180d3?gi=56dfa64da56e" target="_blank" rel="noopener noreferrer">short article on pure function<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h1 id="other-notes"><a href="#other-notes" aria-hidden="true" class="header-anchor">#</a> Other notes</h1> <p>Memoization is awesome. But let's not overuse it. Some things to consider when deciding when to use memoization:</p> <ol><li>Not all functions are memoizable. Only pure functions are.</li> <li>Memoizations have high overhead. Remember, we have to create a cache to store many possible arguments for every memoized function.</li> <li>Memoization is best used on expensive function. Regex calls and recursions are some of them that came into my mind.</li></ol> <h1 id="that-s-nice-but-we-probably-would-never-use-fibonacci-in-real-life-is-there-an-example-of-real-life-use-of-memoization"><a href="#that-s-nice-but-we-probably-would-never-use-fibonacci-in-real-life-is-there-an-example-of-real-life-use-of-memoization" aria-hidden="true" class="header-anchor">#</a> That's nice. But we probably would never use Fibonacci in real life. Is there an example of real life use of memoization?</h1> <p>Yup. <a href="https://vuejs.org/" target="_blank" rel="noopener noreferrer">VueJS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> utilizes memoization. <code>cached(fn)</code> is a memoization wrapper.</p> <div class="language- extra-class"><pre class="language-text"><code>function cached (fn) {
  var cache = Object.create(null);
  return (function cachedFn (str) {
    var hit = cache[str];
    return hit || (cache[str] = fn(str))
  })
}
</code></pre></div><p>And it is being used several times:</p> <div class="language- extra-class"><pre class="language-text"><code>const camelizeRE = /-(\w)/g
export const camelize = cached((str: string): string =&gt; {
  return str.replace(camelizeRE, (_, c) =&gt; c ? c.toUpperCase() : '')
})

export const capitalize = cached((str: string): string =&gt; {
  return str.charAt(0).toUpperCase() + str.slice(1)
})

const hyphenateRE = /\B([A-Z])/g
export const hyphenate = cached((str: string): string =&gt; {
  return str.replace(hyphenateRE, '-$1').toLowerCase()
})
</code></pre></div><p>You can find these function <a href="https://github.com/vuejs/vue/blob/dev/src/shared/util.js" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. (Vue 2.5.0 at the moment of this writing. It might change in the future but you could always go back to previous version).</p> <p>Happy hacking!</p> <h1 id="resources"><a href="#resources" aria-hidden="true" class="header-anchor">#</a> Resources</h1> <p>More readings on memoziation:</p> <ul><li><a href="https://codeburst.io/understanding-memoization-in-3-minutes-2e58daf33a19" target="_blank" rel="noopener noreferrer">Understanding JavaScript Memoization In 3 Minutes<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://inlehmansterms.net/2015/03/01/javascript-memoization/" target="_blank" rel="noopener noreferrer">JavaScript Function Memoization
<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.sitepoint.com/implementing-memoization-in-javascript/" target="_blank" rel="noopener noreferrer">Implementing Memoization in Javascript<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>On pure function:</p> <ul><li><a href="https://blog.bitsrc.io/understanding-javascript-mutation-and-pure-functions-7231cc2180d3" target="_blank" rel="noopener noreferrer">Understanding Javascript Mutation and Pure Functions
<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.411ac2ac.js" defer></script><script src="/assets/js/2.826a9c57.js" defer></script><script src="/assets/js/19.4431ab75.js" defer></script>
  </body>
</html>
