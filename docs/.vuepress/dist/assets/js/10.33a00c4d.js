(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{248:function(e,t,a){"use strict";a.r(t);var r=a(37),o=Object(r.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[a("img",{attrs:{src:"https://thepracticaldev.s3.amazonaws.com/i/dfhkoiqimufpr5zv0z36.gif",alt:"lazy-kat"}})]),e._v(" "),a("p",[e._v("Hello dev.to folks! This is my first post - woot! Pretty excited to share what I have been learning recently about lazy-loading. Please let me know how I can make this better!")]),e._v(" "),a("p",[e._v("Lazy loading image is useful for loading page with many contents. We can easily find libraries to do that, such as "),a("a",{attrs:{href:"https://github.com/malchata/yall.js",target:"_blank",rel:"noopener noreferrer"}},[e._v("yall.js"),a("OutboundLink")],1),e._v(" and "),a("a",{attrs:{href:"https://apoorv.pro/lozad.js/",target:"_blank",rel:"noopener noreferrer"}},[e._v("lozad.js"),a("OutboundLink")],1),e._v(". What most of these libraries have in common is they both use "),a("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API",target:"_blank",rel:"noopener noreferrer"}},[e._v("Intersection Observer API"),a("OutboundLink")],1),e._v(". Let’s learn how to use "),a("code",[e._v("IntersectionObserver")]),e._v(" so we can understand how these libraries work — or even write our own!")]),e._v(" "),a("p",[e._v("First, I will briefly explain what "),a("code",[e._v("IntersectionObserver")]),e._v(" does and second, how to use it to lazy load your own images.")]),e._v(" "),a("h1",{attrs:{id:"what-does-intersectionobserver-do"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#what-does-intersectionobserver-do","aria-hidden":"true"}},[e._v("#")]),e._v(" What Does IntersectionObserver do?")]),e._v(" "),a("p",[e._v("(In layman’s words) "),a("code",[e._v("IntersectionObserver")]),e._v(" "),a("em",[e._v("asynchronously detects when an element intersects with ancestor element (usually viewport) and calls a callback function.")])]),e._v(" "),a("p",[a("img",{attrs:{src:"https://thepracticaldev.s3.amazonaws.com/i/gwvj2lrwfy97ljpj9lv3.png",alt:"viewport schematics"}})]),e._v(" "),a("p",[e._v("Imagine a viewport containing images. When page loads, some images are positioned directly within viewport while some are sitting below viewport, waiting for user to scroll down so they can be seen. As user scrolls down, the top part of some lower-positioned images would eventually intersect with the bottom viewport. It is when the first top image pixel intersects with viewport the callback function loads the image.")]),e._v(" "),a("h1",{attrs:{id:"sample-usage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sample-usage","aria-hidden":"true"}},[e._v("#")]),e._v(" Sample Usage")]),e._v(" "),a("p",[e._v("Let’s read the docs! Mozilla kindly gives us a starting point.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("var options = {\n  root: document.querySelector('#scrollArea'),\n  rootMargin: '0px',\n  threshold: 1.0\n}\n\nvar observer = new IntersectionObserver(callback, options);\nvar target = document.querySelector('#listItem');\nobserver.observe(target);\n")])])]),a("p",[e._v("Above is the minimum setup to lazy load "),a("code",[e._v("#listItem")]),e._v(" (technically options is optional, so "),a("code",[e._v("var observer = new IntersectionObserver(callback);")]),e._v(" is a more concise way to run it).")]),e._v(" "),a("p",[e._v("Aight, let’s use it on a more realistic scenario. We are going to:")]),e._v(" "),a("ol",[a("li",[e._v("Have 10 images in HTML that we will lazy load")]),e._v(" "),a("li",[e._v("Add CSS fade animation")]),e._v(" "),a("li",[e._v("Add IntersectionObserver to load images")])]),e._v(" "),a("h1",{attrs:{id:"html-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#html-setup","aria-hidden":"true"}},[e._v("#")]),e._v(" HTML Setup")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('<div><img data-src=”http://placehold.it/300x300?text=1"></div>\n<div><img data-src=”http://placehold.it/300x300?text=2"></div>\n<div><img data-src=”http://placehold.it/300x300?text=3"></div>\n<div><img data-src=”http://placehold.it/300x300?text=4"></div>\n<div><img data-src=”http://placehold.it/300x300?text=5"></div>\n<div><img data-src=”http://placehold.it/300x300?text=6"></div>\n<div><img data-src=”http://placehold.it/300x300?text=7"></div>\n<div><img data-src=”http://placehold.it/300x300?text=8"></div>\n<div><img data-src=”http://placehold.it/300x300?text=9"></div>\n<div><img data-src=”http://placehold.it/300x300?text=10"></div>\n')])])]),a("p",[e._v("If you notice, it does not use "),a("code",[e._v("src")]),e._v(" but "),a("code",[e._v("data-src")]),e._v(" attribute. One strategy for lazy loading is to start with HTML’s "),a("code",[e._v("data-*")]),e._v(" attribute because "),a("code",[e._v("data-src")]),e._v(" will not load the image.")]),e._v(" "),a("h1",{attrs:{id:"css-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#css-setup","aria-hidden":"true"}},[e._v("#")]),e._v(" CSS Setup")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v(".fade {\n animation-duration: 3s;\n animation-name: fade;\n}\n@keyframes fade {\n from {\n opacity: 0;\n }\n to {\n opacity: 1;\n }\n}\n")])])]),a("p",[e._v("This setup is optional. I think helps with our observation (plus it is more aesthetically pleasing) to have the image lazy load with fade animation.")]),e._v(" "),a("p",[e._v("Btw, you can check when the image is downloaded on network tabs if you use Chrome DevTool.")]),e._v(" "),a("h1",{attrs:{id:"js-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#js-setup","aria-hidden":"true"}},[e._v("#")]),e._v(" JS Setup")]),e._v(" "),a("p",[e._v("I want the images to load only when 50% of it intersects with viewport. This is how to set it up:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("const images = document.querySelectorAll(‘img’)\nconst observer = new IntersectionObserver(entries => {\n entries.forEach(entry => {\n if(entry.isIntersecting) {\n const target = entry.target\n target.setAttribute(‘src’, target.dataset.src)\n target.classList.add(‘fade’)\n observer.unobserve(target)\n }\n })\n}, {\n threshold: 0.5\n})\nimages.forEach(image => observer.observe(image))\n")])])]),a("p",[e._v("I want to highlight a few things that I was struggling to understand when learning IntersectionObserver.")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("The argument entries represents all the image element under "),a("code",[e._v("IntersectionObserver")]),e._v(" (I find it a bit odd having to iterate twice with "),a("code",[e._v("images.forEach")]),e._v(" and "),a("code",[e._v("entries.forEach")]),e._v(", but that’s the way it is done). At initial page load, all entries are called. Some immediately intersects (if they are within viewports when page renders) while some don’t. The ones that immediately intersects have their callback function called immediately.")])]),e._v(" "),a("li",[a("p",[a("code",[e._v("entry.isIntersecting")]),e._v(" returns true when the image intersects with viewport. Another common check for intersectionality is "),a("code",[e._v("entry.intersectionRatio > 0")]),e._v(".")])]),e._v(" "),a("li",[a("p",[e._v("As mentioned before, a common strategy for lazy-loading is to initially start without "),a("code",[e._v("src")]),e._v(". We transfer values from "),a("code",[e._v("data-src")]),e._v(" to "),a("code",[e._v("src")]),e._v(" right before user is about to see it.")])]),e._v(" "),a("li",[a("p",[e._v("It is good practice to unobserve the object after it has been loaded.\nWe can change the amount or location of intersectionality with either "),a("code",[e._v("threshold")]),e._v(" or "),a("code",[e._v("rootMargin")]),e._v(" option. The ancestor element can be changed with root (default is viewport).")])])]),e._v(" "),a("h1",{attrs:{id:"conclusion"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#conclusion","aria-hidden":"true"}},[e._v("#")]),e._v(" Conclusion")]),e._v(" "),a("p",[e._v("At the time of this writing, intersectionObserver is usable in major browsers except for IE. Check "),a("a",{attrs:{href:"https://caniuse.com/#feat=intersectionobserver",target:"_blank",rel:"noopener noreferrer"}},[e._v("caniuse"),a("OutboundLink")],1),e._v(" site for complete list.")]),e._v(" "),a("p",[a("code",[e._v("IntersectionObserver")]),e._v(" is useful to lazy load element into viewport by passing the value from data-src into src upon callback. The same strategy can be applied to other elements.")]),e._v(" "),a("p",[e._v("Below are articles I read regarding "),a("code",[e._v("IntersectionObserver")]),e._v(" I found useful (I am not affiliated with any of them, just appreciative of the information they gave and I hope it will help you too!)")]),e._v(" "),a("ul",[a("li",[a("p",[a("a",{attrs:{href:"https://fireship.io/snippets/intersection-observer-lazy-load-images/",target:"_blank",rel:"noopener noreferrer"}},[e._v("fireship"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://alligator.io/js/intersection-observer/",target:"_blank",rel:"noopener noreferrer"}},[e._v("alligatorio"),a("OutboundLink")],1)])]),e._v(" "),a("li",[a("p",[a("a",{attrs:{href:"https://developers.google.com/web/fundamentals/performance/lazy-loading-guidance/images-and-video/",target:"_blank",rel:"noopener noreferrer"}},[e._v("googledev"),a("OutboundLink")],1)])])]),e._v(" "),a("p",[e._v("Please feel free to let me know if you find any mistakes or how I can improve this. Thank you so much for reading this far. Y’all are awesome!")])])},[],!1,null,null,null);t.default=o.exports}}]);